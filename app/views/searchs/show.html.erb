<% content_for :css do %>
  <%= stylesheet_link_tag '/assets/searchs/show', media: "screen and (max-width: 559px)" %>
  <%= stylesheet_link_tag '/assets/searchs/tablet/show_tab', media: "screen and (min-width: 560px) and (max-width: 959px)" %>
  <%= stylesheet_link_tag '/assets/searchs/pc/show_pc', media: "screen and (min-width: 960px)" %>
<% end %>

<%= render 'layouts/header' %>
<div class="main__wrapper">
  <div class="ggrmap__wrapper">
    <h1>マップ</h1>
    <p><%= @shop.address %></p>
    <div class="ggrmap-dtl" id="js-map"></div>
  </div>
</div>

<script type="text/javascript">
(() => {
  const initMap = () => {
    // InvalidValueError: initMap is not a functionの対応
    window.onload = function () {
      initMap();
    };
    // latitude,longitudeから位置を特定
    let place = { lat: <%= @shop.latitude %>, lng: <%= @shop.longitude %> };
    let map = new google.maps.Map(document.getElementById('js-map'), {
              zoom: 14, 
              // center: {lat: 35.18, lng: 136.906}
              center: place
              });
    let transitLayer = new google.maps.TransitLayer();
    transitLayer.setMap(map);
  
    let contentString = '住所：<%= @shop.address %>';
    let infowindow = new google.maps.InfoWindow({
      content: contentString
    });
  
    // Map上の指定した位置にピンを挿して表示する
    let marker = new google.maps.Marker({
                  // position: {lat: 35.18, lng: 136.906},
                  position: place,
                  map: map,
                  title: contentString
                  });
  
      marker.addListener('click', function() {
        infowindow.open(map, marker);
      });
  };
  initMap();
})();
</script>
